# ============================================================================
# SECTION 1 — Infrastructure (env-only, requires restart)
#
# These variables CANNOT be changed at runtime via Admin Settings.
# They control server binding, database connections, and cryptographic keys.
# ============================================================================

# Server
PORT=3000
HOST=0.0.0.0
# NODE_ENV=production

# Database
DATABASE_URL=postgresql://postgres:postgres@localhost:5432/agentim

# Redis (optional — omit for single-node deployments)
# REDIS_URL=redis://localhost:6379

# Auto-run database migrations on startup (set "false" for multi-replica deploys)
# RUN_MIGRATIONS=true

# JWT secrets (REQUIRED: generate with `openssl rand -hex 32`)
JWT_SECRET=change-me-to-a-random-secret
# JWT_SECRET_PREVIOUS=          # Previous secret for graceful key rotation

# Admin credentials (seeded on startup)
ADMIN_USERNAME=admin
ADMIN_PASSWORD=ChangeMe123!

# File uploads (local storage path)
UPLOAD_DIR=./uploads

# Encryption key for secrets at rest (REQUIRED in production, min 32 chars)
# Generate with: openssl rand -hex 32
ENCRYPTION_KEY=

# ============================================================================
# SECTION 2 — Initial defaults (runtime-configurable via Admin Settings)
#
# These are fallback values used BEFORE any Admin Settings DB value is saved.
# Once configured in the Admin Settings web UI, the DB value takes precedence.
# You can omit all of the variables below to use the built-in defaults.
# ============================================================================

# --- Security ---
# CORS_ORIGIN=http://localhost:5173   # Auto-detected from RENDER_EXTERNAL_URL / RAILWAY_PUBLIC_DOMAIN
# TRUST_PROXY=false                   # Set "true" behind a reverse proxy
# JWT_ACCESS_EXPIRY=15m
# JWT_REFRESH_EXPIRY=7d
# TOTP_ISSUER=AgentIM

# --- OAuth providers (leave empty to disable) ---
# OAUTH_GITHUB_CLIENT_ID=
# OAUTH_GITHUB_CLIENT_SECRET=
# OAUTH_GOOGLE_CLIENT_ID=
# OAUTH_GOOGLE_CLIENT_SECRET=

# --- Storage ---
# STORAGE_PROVIDER=local              # 'local' or 's3'
# MAX_FILE_SIZE=10485760              # 10 MB
# S3_BUCKET=
# S3_REGION=auto
# S3_ENDPOINT=                        # For R2/MinIO
# S3_ACCESS_KEY_ID=
# S3_SECRET_ACCESS_KEY=

# --- AI Router (per-router defaults — routers are managed via the web UI) ---
# ROUTER_LLM_BASE_URL=               # OpenAI-compatible API URL
# ROUTER_LLM_API_KEY=
# ROUTER_LLM_MODEL=
# ROUTER_LLM_TIMEOUT_MS=15000
# MAX_AGENT_CHAIN_DEPTH=5

# --- Rate limiting ---
# CLIENT_RATE_LIMIT_WINDOW=10        # Window in seconds (1-300)
# CLIENT_RATE_LIMIT_MAX=30           # Max messages per window (1-1000)
# AGENT_RATE_LIMIT_WINDOW=60
# AGENT_RATE_LIMIT_MAX=20

# --- Connection limits ---
# MAX_WS_CONNECTIONS_PER_USER=10
# MAX_TOTAL_WS_CONNECTIONS=5000
# MAX_GATEWAYS_PER_USER=20

# --- Maintenance ---
# ORPHAN_FILE_CHECK_INTERVAL=3600000  # 1 hour
# TOKEN_CLEANUP_INTERVAL=3600000      # 1 hour
# AUDIT_LOG_RETENTION_DAYS=90
# AUDIT_LOG_CLEANUP_INTERVAL=86400000 # 24 hours
# GATEWAY_CLEANUP_INTERVAL=86400000   # 24 hours
# GATEWAY_MAX_OFFLINE_DAYS=30

# --- Monitoring ---
# SENTRY_DSN=
# LOG_LEVEL=info                      # debug | info | warn | error | fatal
# METRICS_AUTH_ENABLED=true           # Require JWT for /api/metrics (default: true in production)
